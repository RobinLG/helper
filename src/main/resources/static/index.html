<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>jquery图片居中放大代码</title>
<link href="css/style.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="js/jquery.js"></script>
<script type="text/javascript">
$(function () {
    var imagesNum = 0;
    getImages()
	imgZoomInit()//模块初始化

})


/*
* 图片放大展示

*/
function imgZoomInit(){
	$('.piclist li.pic').append(function(){
		ht = $(this).find('.in').html();
		return "<div class='original'>"+ht+"</div>";
	});
	
	$(".piclist li.pic .in img").each(function(i){
		var img = $(this);
		var realWidth ;//原始宽度
		var realHeight ;//原始高度
		var vs ;//图片宽高比
		
		realWidth = this.width;
		realHeight = this.height;
		vs = realWidth/realHeight;
			
		//缩略图比例230:142(约等于1.62)
		if(vs>=1.62){//横图则固定高度
			$(img).css("width","auto").css("height","142px").css("marginLeft",115-(71*realWidth/realHeight)+"px");
		}
		else{//竖图则固定宽度
			$(img).css("width","230px").css("height","auto").css("marginTop",71-(115*realHeight/realWidth)+"px");
		}
		
		//图片放大水平垂直居中显示
		if(vs>=1){//横图或正方形
			$(img).parent().parent().parent().find('.original img').height(260);
			$(img).parent().parent().parent().find('.original img').width('auto');
			$(img).parent().parent().parent().find('.original').css({
				//此处需结合实际情况计算 左偏移：.original实际宽度的二分之一
				marginLeft: function(){
					return -(130*realWidth/realHeight)-6;
				},
				left:'50%'
			})
		}else{//竖图
			$(img).parent().parent().parent().find('.original img').width(260);
			$(img).parent().parent().parent().find('.original img').height('auto');
			$(img).parent().parent().parent().find('.original').css({
				//此处需结合实际情况计算 上偏移：.original实际高度的二分之一
				marginTop: function(){
					return -(130*realHeight/realWidth)-36;
				},
				top:'50%'
			});
			$(img).parent().parent().parent().find('.original b').css('display','block')
		}		
	});

	
	$('.piclist li.pic').hover(function(){
			$(this).addClass('on');
		},function(){
			$(this).removeClass('on');	
	})
	
	$(".piclist ul li:nth-child(4n)").addClass('r');
}

function getImages() {

    $.ajax({
        type: "get",
        url: "/loadImg",
        success: function(data) {
            var itemStr = "";
            imagesNum = Object.keys(data).length;
            for (var i in data) {
                itemStr += '<li class="pic" id="tes"><div class="in">'
                itemStr += '<div class="imgdiv"><img id="' + i + '" src="' + data[i] + '" alt="" width="100%" height="100%"/></div>';
                itemStr += '<span><b><a href="/getImgMdFive?fileName=' + i + '">download</a></b></span></div></li>'
            }
            $("#img_ul").html(itemStr);
        }
    });
}

</script>
</head>

<body>
<!-- 要求img标签必须带上width和height属性 -->
<div class="picbox">

    <div class="picshow picshow01">
        <div class="piclist">
            <ul id="img_ul">

            </ul>
        </div>
    
    </div>
       
</div>

</div>
</body>
</html>
